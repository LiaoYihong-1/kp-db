{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\x1761\\\\Desktop\\\\refactoring\\\\demo_front\\\\my-app\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import React,{useEffect,useState}from\"react\";import Typography from\"@material-ui/core/Typography\";import $ from\"jquery\";import TableContainer from\"@material-ui/core/TableContainer\";import Paper from\"@material-ui/core/Paper\";import Table from\"@material-ui/core/Table\";import TableHead from\"@material-ui/core/TableHead\";import TableRow from\"@material-ui/core/TableRow\";import TableCell from\"@material-ui/core/TableCell\";import TableBody from\"@material-ui/core/TableBody\";import Container from\"@material-ui/core/Container\";import Button from\"@material-ui/core/Button\";import Grid from\"@material-ui/core/Grid\";import IconButton from\"@material-ui/core/IconButton\";import KeyboardArrowUpIcon from\"@material-ui/icons/KeyboardArrowUp\";import KeyboardArrowDownIcon from\"@material-ui/icons/KeyboardArrowDown\";import Collapse from\"@material-ui/core/Collapse\";import Box from\"@material-ui/core/Box\";import Modal from\"@material-ui/core/Modal\";import Backdrop from\"@material-ui/core/Backdrop\";import Fade from\"@material-ui/core/Fade\";import{makeStyles}from\"@material-ui/core/styles\";import AddAction from\"./addAction\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useRowStyles=makeStyles({root:{'& > *':{borderBottom:'unset'}}});var useStyles=makeStyles(function(theme){return{modal:{display:'flex',alignItems:'center',justifyContent:'center'},paper:{backgroundColor:theme.palette.background.paper,border:'2px solid #000',boxShadow:theme.shadows[5],padding:theme.spacing(2,4,3)}};});var scripts=[];function Action(props){var action=props.action;var classes=useRowStyles();return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(TableRow,{className:classes.root,children:[/*#__PURE__*/_jsx(TableCell,{component:\"th\",scope:\"row\",children:action.id}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:action.action_type}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:action.target_id}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:action.target_type})]})});}function Script(props){var classes=useRowStyles();var formclasses=useStyles();var script=props.script;var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),open=_React$useState2[0],setOpen=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),formopen=_React$useState4[0],setFormopen=_React$useState4[1];var _useState=useState(false),_useState2=_slicedToArray(_useState,2),getaction=_useState2[0],setGetaction=_useState2[1];function getAction(){$.ajax({url:\"api/getActions\",method:\"POST\",data:{script_id:script.id},async:false,success:function success(res){script.action.length=0;for(var i in res){script.action.push({id:res[i].action_id,target_id:res[i].target_id,action_type:res[i].action_type,target_type:res[i].target_type});}setGetaction(true);}});}useEffect(function(){if(!getaction){getAction();}});return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsxs(TableRow,{className:classes.root,children:[/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"expand row\",size:\"small\",onClick:function onClick(){return setOpen(!open);},children:open?/*#__PURE__*/_jsx(KeyboardArrowUpIcon,{}):/*#__PURE__*/_jsx(KeyboardArrowDownIcon,{})})}),/*#__PURE__*/_jsx(TableCell,{component:\"th\",children:script.id}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:script.condition}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:/*#__PURE__*/_jsx(Button,{color:\"primary\",children:\"Execute\"})})]}),/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:/*#__PURE__*/_jsx(Collapse,{in:open,timeout:\"auto\",unmountOnExit:true,children:/*#__PURE__*/_jsxs(Box,{margin:1,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",gutterBottom:true,component:\"div\",children:\"Actions\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",size:\"small\",onClick:function onClick(){return setFormopen(!formopen);},children:\"Add Action\"}),/*#__PURE__*/_jsxs(Table,{size:\"small\",\"aria-label\":\"purchases\",children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Action ID\"})}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Type\"})}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Furniture\"})}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Furniture Type\"})})]})}),/*#__PURE__*/_jsx(TableBody,{children:script.action.map(function(a){return/*#__PURE__*/_jsx(Action,{action:a});})})]}),/*#__PURE__*/_jsx(Modal,{\"aria-labelledby\":\"transition-modal-title\",\"aria-describedby\":\"transition-modal-description\",className:formclasses.modal,open:formopen,onClose:function onClose(){return setFormopen(false);},closeAfterTransition:true,BackdropComponent:Backdrop,BackdropProps:{timeout:500},children:/*#__PURE__*/_jsx(Fade,{in:formopen,children:/*#__PURE__*/_jsx(\"div\",{className:formclasses.paper,children:/*#__PURE__*/_jsx(AddAction,{type:\"condition\",script_id:script.id})})})})]})})})})]});}function CollapsibleTableConditonal(){var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),getscript=_useState4[0],setGetscript=_useState4[1];function getScript(){$.ajax({url:\"api/getconditionscript\",method:\"POST\",data:{id:window.sessionStorage.getItem(\"id\")},async:false,success:function success(res){scripts.length=0;for(var i in res){scripts.push({id:res[i].script_id,condition:res[i].condition,action:[]});}setGetscript(true);}});}useEffect(function(){if(!getscript){getScript();}});return/*#__PURE__*/_jsx(TableContainer,{component:Paper,children:/*#__PURE__*/_jsxs(Table,{\"aria-label\":\"collapsible table\",children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:\"Id\"})}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:\"Condition\"})}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:\"Run by a click\"})})]})}),/*#__PURE__*/_jsx(TableBody,{children:scripts.map(function(script){return/*#__PURE__*/_jsx(Script,{script:script});})})]})});}export default function MainScript(){return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(Grid,{children:/*#__PURE__*/_jsx(CollapsibleTableConditonal,{})})});}","map":{"version":3,"sources":["C:/Users/x1761/Desktop/refactoring/demo_front/my-app/src/components/main/mainScript.jsx"],"names":["React","useEffect","useState","Typography","$","TableContainer","Paper","Table","TableHead","TableRow","TableCell","TableBody","Container","Button","Grid","IconButton","KeyboardArrowUpIcon","KeyboardArrowDownIcon","Collapse","Box","Modal","Backdrop","Fade","makeStyles","AddAction","useRowStyles","root","borderBottom","useStyles","theme","modal","display","alignItems","justifyContent","paper","backgroundColor","palette","background","border","boxShadow","shadows","padding","spacing","scripts","Action","props","action","classes","id","action_type","target_id","target_type","Script","formclasses","script","open","setOpen","formopen","setFormopen","getaction","setGetaction","getAction","ajax","url","method","data","script_id","async","success","res","length","i","push","action_id","condition","paddingBottom","paddingTop","map","a","timeout","CollapsibleTableConditonal","getscript","setGetscript","getScript","window","sessionStorage","getItem","MainScript"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from \"react\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport $ from \"jquery\";\r\nimport TableContainer from \"@material-ui/core/TableContainer\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Table from \"@material-ui/core/Table\";\r\nimport TableHead from \"@material-ui/core/TableHead\";\r\nimport TableRow from \"@material-ui/core/TableRow\";\r\nimport TableCell from \"@material-ui/core/TableCell\";\r\nimport TableBody from \"@material-ui/core/TableBody\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport KeyboardArrowUpIcon from \"@material-ui/icons/KeyboardArrowUp\";\r\nimport KeyboardArrowDownIcon from \"@material-ui/icons/KeyboardArrowDown\";\r\nimport Collapse from \"@material-ui/core/Collapse\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Modal from \"@material-ui/core/Modal\";\r\nimport Backdrop from \"@material-ui/core/Backdrop\";\r\nimport Fade from \"@material-ui/core/Fade\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport AddAction from \"./addAction\";\r\nconst useRowStyles = makeStyles({\r\n    root: {\r\n        '& > *': {\r\n            borderBottom: 'unset',\r\n        },\r\n    },\r\n\r\n});\r\nconst useStyles = makeStyles((theme) => ({\r\n    modal: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n    },\r\n    paper: {\r\n        backgroundColor: theme.palette.background.paper,\r\n        border: '2px solid #000',\r\n        boxShadow: theme.shadows[5],\r\n        padding: theme.spacing(2, 4, 3),\r\n    },\r\n}));\r\nconst scripts = [];\r\nfunction Action(props){\r\n    const {action} = props;\r\n    const classes = useRowStyles();\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <TableRow className={classes.root}>\r\n                <TableCell component=\"th\" scope=\"row\">\r\n                    {action.id}\r\n                </TableCell>\r\n                <TableCell align=\"right\">{action.action_type}</TableCell>\r\n                <TableCell align=\"right\">{action.target_id}</TableCell>\r\n                <TableCell align=\"right\">{action.target_type}</TableCell>\r\n            </TableRow>\r\n        </React.Fragment>\r\n    );\r\n}\r\nfunction Script(props){\r\n    const classes = useRowStyles();\r\n    const formclasses = useStyles();\r\n    const {script} = props;\r\n    const [open, setOpen] = React.useState(false);\r\n    const [formopen,setFormopen] = React.useState(false);\r\n    const [getaction,setGetaction] = useState(false);\r\n    function getAction(){\r\n        $.ajax({\r\n                url: \"api/getActions\",\r\n                method:\"POST\",\r\n                data:{\r\n                    script_id:script.id\r\n                },\r\n                async:false,\r\n                success:function (res){\r\n                    script.action.length = 0;\r\n                    for(var i in res){\r\n                        script.action.push(\r\n                            {\r\n                                id:res[i].action_id,\r\n                                target_id:res[i].target_id,\r\n                                action_type:res[i].action_type,\r\n                                target_type:res[i].target_type\r\n                            }\r\n                        )\r\n                    }\r\n                    setGetaction(true);\r\n                }\r\n            }\r\n        );\r\n    }\r\n    useEffect(()=>{\r\n        if(!getaction){\r\n            getAction();\r\n        }\r\n    })\r\n    return (\r\n        <React.Fragment>\r\n            <TableRow className={classes.root}>\r\n                <TableCell>\r\n                    <IconButton aria-label=\"expand row\" size=\"small\" onClick={() => setOpen(!open)}>\r\n                        {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\r\n                    </IconButton>\r\n                </TableCell>\r\n                <TableCell component=\"th\">\r\n                    {script.id}\r\n                </TableCell>\r\n                <TableCell align=\"right\">{script.condition}</TableCell>\r\n                <TableCell align=\"right\"><Button  color=\"primary\">Execute</Button></TableCell>\r\n            </TableRow>\r\n            <TableRow>\r\n                <TableCell style={{ paddingBottom: 0, paddingTop: 0 }} colSpan={6}>\r\n                    <Collapse in={open} timeout=\"auto\" unmountOnExit>\r\n                        <Box margin={1}>\r\n                            <Typography variant=\"h5\" gutterBottom component=\"div\">\r\n                                Actions\r\n                            </Typography>\r\n                            <Button variant=\"contained\" color=\"primary\" size={\"small\"} onClick={()=>setFormopen(!formopen)}>\r\n                                Add Action\r\n                            </Button>\r\n                            <Table size=\"small\" aria-label=\"purchases\">\r\n                                <TableHead>\r\n                                    <TableRow>\r\n                                        <TableCell><Typography variant={\"h6\"}>Action ID</Typography></TableCell>\r\n                                        <TableCell  align=\"right\"><Typography variant={\"h6\"}>Type</Typography></TableCell>\r\n                                        <TableCell align=\"right\"><Typography variant={\"h6\"}>Furniture</Typography></TableCell>\r\n                                        <TableCell align=\"right\"><Typography variant={\"h6\"}>Furniture Type</Typography></TableCell>\r\n                                    </TableRow>\r\n                                </TableHead>\r\n                                <TableBody>\r\n                                    {\r\n                                        script.action.map((a)=>(\r\n                                            <Action action={a}/>\r\n                                            )\r\n                                        )\r\n                                    }\r\n                                </TableBody>\r\n                            </Table>\r\n                            <Modal\r\n                                aria-labelledby=\"transition-modal-title\"\r\n                                aria-describedby=\"transition-modal-description\"\r\n                                className={formclasses.modal}\r\n                                open={formopen}\r\n                                onClose={()=>setFormopen(false)}\r\n                                closeAfterTransition\r\n                                BackdropComponent={Backdrop}\r\n                                BackdropProps={{\r\n                                    timeout: 500,\r\n                                }}\r\n                            >\r\n                                <Fade in={formopen}>\r\n                                    <div className={formclasses.paper}>\r\n                                        <AddAction type=\"condition\" script_id={script.id}/>\r\n                                    </div>\r\n                                </Fade>\r\n                            </Modal>\r\n                        </Box>\r\n                    </Collapse>\r\n                </TableCell>\r\n            </TableRow>\r\n        </React.Fragment>\r\n    );\r\n}\r\nfunction CollapsibleTableConditonal() {\r\n    const [getscript,setGetscript] = useState(false);\r\n    function getScript(){\r\n        $.ajax({\r\n                url: \"api/getconditionscript\",\r\n                method:\"POST\",\r\n                data:{\r\n                    id:window.sessionStorage.getItem(\"id\")\r\n                },\r\n                async:false,\r\n                success:function (res){\r\n                    scripts.length = 0;\r\n                    for(var i in res){\r\n                        scripts.push(\r\n                            {\r\n                                id:res[i].script_id,\r\n                                condition:res[i].condition,\r\n                                action:[]\r\n                            }\r\n                        )\r\n                    }\r\n                    setGetscript(true);\r\n                }\r\n            }\r\n        );\r\n    }\r\n    useEffect(()=>{\r\n        if(!getscript){\r\n            getScript();\r\n        }\r\n    });\r\n    return (\r\n        <TableContainer component={Paper}>\r\n            <Table aria-label=\"collapsible table\">\r\n                <TableHead>\r\n                    <TableRow>\r\n                        <TableCell/>\r\n                        <TableCell><Typography variant={\"h4\"}>Id</Typography></TableCell>\r\n                        <TableCell align=\"right\"><Typography variant={\"h4\"}>Condition</Typography></TableCell>\r\n                        <TableCell align=\"right\"><Typography variant={\"h4\"}>Run by a click</Typography></TableCell>\r\n                    </TableRow>\r\n                </TableHead>\r\n                <TableBody>\r\n                    {scripts.map((script)=>(\r\n                        <Script script={script}/>\r\n                    ))}\r\n                </TableBody>\r\n            </Table>\r\n        </TableContainer>\r\n    );\r\n}\r\n\r\nexport default function MainScript(){\r\n    return(\r\n        <Container>\r\n            <Grid>\r\n                <CollapsibleTableConditonal/>\r\n            </Grid>\r\n        </Container>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}